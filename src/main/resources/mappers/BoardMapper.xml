<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.deft.crud.board.model.dao.BoardMapper">
<resultMap type="com.deft.crud.board.model.dto.BoardDTO" id="boardResultMap">
	<id property="boardNo" column="BOARD_NO"/>
	<result property="writeNo" column="WRITE_NO"/>
	<result property="boardName" column="BOARD_NAME"/>
	<result property="empName" column="EMP_NAME"/>
	<result property="writeDate" column="WRITE_DATE"/>
	<result property="views" column="VIEWS"/>
	<result property="contents" column="CONTENTS"/>
	<result property="type" column="TYPE"/>
	<result property="empNo" column="EMP_NO"/>
</resultMap>
	<select id="selectFreeboard" resultMap="boardResultMap">
		SELECT
               B.WRITE_NO
             , B.BOARD_NAME
             , E.EMP_NAME
             , B.WRITE_DATE
             , B.VIEWS
          FROM TBL_BOARD B
          JOIN TBL_EMP_INFO E ON (E.EMP_NO = B.EMP_NO)
         WHERE B.BOARD_NO LIKE 2
	</select>
	<select id="selectNotice" resultMap="boardResultMap">
		SELECT
               B.WRITE_NO
             , B.BOARD_NAME
             , E.EMP_NAME
             , B.WRITE_DATE
             , B.VIEWS
          FROM TBL_BOARD B
          JOIN TBL_EMP_INFO E ON (E.EMP_NO = B.EMP_NO)
         WHERE B.BOARD_NO LIKE 1
	</select>
	
	<insert id="insertFreeboard" parameterType="com.deft.crud.board.model.dto.BoardDTO">
		INSERT
		  INTO TBL_BOARD B
		     (
		       B.WRITE_NO
		     , B.BOARD_NO 
		     , B.BOARD_NAME
		     , B.EMP_NO
		     , B.WRITE_DATE
		     , B.CONTENTS
		     , B.TYPE
		     )
		VALUES
		     (
		       SEQ_WRITE_NO.NEXTVAL
		     , 2  
		     , #{ boardName }  
		     , #{ empNo }
		     , SYSDATE
		     , #{ contents }
		     , '자유게시판'
		     )
	</insert>
	
	<delete id="deleteFreeboard" parameterType="com.deft.crud.board.model.dto.BoardDTO">
		DELETE
		  FROM TBL_BOARD B
		 WHERE B.BOARD_NO = #{ boardNo, jdbcType = INTEGER }
	</delete>
	
	<delete id="deleteNotice" parameterType="com.deft.crud.board.model.dto.BoardDTO">
		DELETE
		  FROM TBL_BOARD B
		 WHERE B.BOARD_NO = #{ boardNo, jdbcType = INTEGER }
	</delete>
	
	<select id="freeboardDetail" parameterType="_int" resultType="com.deft.crud.board.model.dto.BoardDTO">
		SELECT
		      
		       B.BOARD_NO
		     , B.WRITE_NO
             , B.BOARD_NAME
             , E.EMP_NAME
             , B.CONTENTS
             , B.WRITE_DATE
             , B.VIEWS
          FROM TBL_BOARD B
          JOIN TBL_EMP_INFO E ON (E.EMP_NO = B.EMP_NO)
         WHERE B.BOARD_NO = 2
           AND B.WRITE_NO = #{ writeNo }
	</select>
	<select id="noticeDetail" parameterType="_int" resultType="com.deft.crud.board.model.dto.BoardDTO">
		SELECT
		      
		       B.BOARD_NO
		     , B.WRITE_NO
             , B.BOARD_NAME
             , E.EMP_NAME
             , B.CONTENTS
             , B.WRITE_DATE
             , B.VIEWS
          FROM TBL_BOARD B
          JOIN TBL_EMP_INFO E ON (E.EMP_NO = B.EMP_NO)
         WHERE B.BOARD_NO = 1
           AND B.WRITE_NO = #{ writeNo }
	</select>
	
	<update id="freeboardviewCount" parameterType="_int">
		UPDATE TBL_BOARD B
		   SET B.VIEWS = VIEWS + 1
	     WHERE B.WRITE_NO = #{ writeNo }
	</update>
	
	<update id="noticeviewCount" parameterType="_int">
		UPDATE TBL_BOARD B
		   SET B.VIEWS = VIEWS + 1
	     WHERE B.WRITE_NO = #{ writeNo }
	
	</update>
</mapper>